<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login Seguro</title>
<style>
  body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background: #f0f0f0; margin: 0; }

  /* Formulario */
  #loginForm {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    width: 300px;
    position: relative;
    z-index: 1;
  }
  h2 { text-align: center; margin-bottom: 20px; }
  input { display: block; width: 100%; margin: 10px 0; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
  button { width: 100%; padding: 10px; background: #0056b3; color: white; border: none; border-radius: 4px; cursor: pointer; }
  button:hover { background: #004494; }

  /* Overlay con spinner */
  #loadingOverlay {
    display: none;
    position: fixed;       /* cubrir toda la pantalla */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255,255,255,0.8); /* semitransparente */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;           /* encima del formulario */
  }

  /* Spinner */
  .spinner {
    border: 4px solid #f3f3f3;
    border-top: 4px solid #0056b3;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin-bottom: 10px;
  }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

  #loadingOverlay div { color: #0056b3; text-align: center; font-weight: bold; }
</style>
</head>
<body>

<form id="loginForm">
  <h2>Iniciar Sesi칩n</h2>
  <input type="text" id="usuario" placeholder="Usuario" required>
  <input type="password" id="clave" placeholder="Clave" required>
  <button type="submit">Ingresar</button>
</form>

<!-- Overlay con spinner -->
<div id="loadingOverlay">
  <div class="spinner"></div>
  <div>Actualizando p치gina, por favor espere...</div>
</div>

<script>
document.getElementById("loginForm").addEventListener("submit", async function(e){
  e.preventDefault();

  const usuario = document.getElementById("usuario").value.trim();
  const clave = document.getElementById("clave").value.trim();
  const loadingOverlay = document.getElementById("loadingOverlay");

  // Mostrar overlay encima del formulario
  loadingOverlay.style.display = "flex";

  const url = "https://script.google.com/macros/s/AKfycbxv9MA2tQmda4RigzSs-K9h0WTXjCXAfK642SzE6k6KobWInbRy0KsvAnxcw_6V-Iut/exec";

  try {
    const response = await fetch(url, {
      method: "POST",
      body: new URLSearchParams({usuario, clave, token: "#####%%%256//&&*****"})
    });

    const result = await response.json();

    if(result.success){
      localStorage.setItem("usuario", usuario);
      localStorage.setItem("rol", result.rol);
      localStorage.setItem("correo", result.correo);

      // Redirigir con peque침o delay para que el usuario vea el spinner
      setTimeout(() => {
        window.location.href = "https://msilva-ux.github.io/prev2/#";
      }, 500);
    } else {
      loadingOverlay.style.display = "none"; // ocultar overlay si error
      alert("Usuario o clave incorrectos");
    }
  } catch(err){
    loadingOverlay.style.display = "none";
    console.error(err);
    alert("Error de conexi칩n. Intente nuevamente.");
  }
});
</script>

</body>
</html>


  
